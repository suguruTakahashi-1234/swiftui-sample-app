name: Auto Move PR to Review Column

on:
  pull_request:
    types: [opened]

jobs:
  move-card:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/github-script@v6
      with:
        github-token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
        script: |
          const projectId = 1;
          const columnName = "ðŸ‘€ In Review (PR)";

          async function getColumnId() {
            const columns = await github.projects.listColumns({ project_id: projectId });
            const column = columns.data.find(col => col.name === columnName);
            if (column) {
              return column.id;
            } else {
              throw new Error(`Column "${columnName}" not found`);
            }
          }

          async function run() {
            const columnId = await getColumnId();
            await github.projects.createCard({
              column_id: columnId,
              content_id: github.context.payload.pull_request.id,
              content_type: 'PullRequest'
            });
          }

          run();
